name: Text

on:
 push:
  paths:
  - '.github/workflows/text.yml'
  - 'Fallout2/Fallout1in2/**/*.[Mm][Ss][Gg]'
  - 'Tools/ScanMsg/ScanMsg.exe'
 pull_request:
  paths:
  - '.github/workflows/text.yml'
  - 'Fallout2/Fallout1in2/**/*.[Mm][Ss][Gg]'
  - 'Tools/ScanMsg/ScanMsg.exe'

defaults:
 run:
  shell: bash

jobs:
 All:
  if:      github.ref == 'refs/heads/master'
  runs-on: windows-latest
  steps:

  - name: Clone
    uses: actions/checkout@v2

  - name: ScanMsg (local)
    uses: wipe2238/ScanMsg@master
    with:
     executable: Tools/ScanMsg/ScanMsg.exe
     workdir:    Fallout2/Fallout1in2/mods/

  - name: ScanMsg (upstream)
    uses: wipe2238/ScanMsg@master
    with:
     workdir:    Fallout2/Fallout1in2/mods/

 English:
  if:      github.ref == 'refs/heads/fo1_french' || github.ref == 'refs/heads/fo1_german'
  runs-on: windows-latest
  steps:

  - name: Clone
    uses: actions/checkout@v2

  - name: ScanMsg (local)
    uses: wipe2238/ScanMsg@master
    with:
     path:       fo1_base/text/english/
     executable: Tools/ScanMsg/ScanMsg.exe
     workdir:    Fallout2/Fallout1in2/mods/

  - name: ScanMsg (upstream)
    uses: wipe2238/ScanMsg@master
    with:
     workdir:    Fallout2/Fallout1in2/mods/

 French:
  if:      github.ref == 'refs/heads/fo1_french'
  needs:   English
  runs-on: windows-latest

  steps:

  - name: Clone
    uses: actions/checkout@v2

  - name: ScanMsg (local)
    uses: wipe2238/ScanMsg@master
    with:
     path:         fo1_base/text/english/
     translations: fo1_french/text/french/
     executable:   Tools/ScanMsg/ScanMsg.exe
     workdir:      Fallout2/Fallout1in2/mods/

  - name: ScanMsg (upstream)
    uses: wipe2238/ScanMsg@master
    with:
     path:         fo1_base/text/english/
     translations: fo1_french/text/french/
     workdir:      Fallout2/Fallout1in2/mods/

 German:
  if:      github.ref == 'refs/heads/fo1_german'
  needs:   English
  runs-on: windows-latest

  steps:

  - name: Clone
    uses: actions/checkout@v2

  - name: ScanMsg (local)
    uses: wipe2238/ScanMsg@master
    with:
     path:         fo1_base/text/english/
     translations: fo1_german/text/german/
     executable:   Tools/ScanMsg/ScanMsg.exe
     workdir:      Fallout2/Fallout1in2/mods/

  - name: ScanMsg (upstream)
    uses: wipe2238/ScanMsg@master
    with:
     path:         fo1_base/text/english/
     translations: fo1_german/text/german/
     workdir:      Fallout2/Fallout1in2/mods/
